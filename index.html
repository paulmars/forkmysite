<div id="maincontent">
  <div id="card" class="pane">
    <h1>
      Paul McKellar
    </h1>
    <p>
      SVAngel. @Square founding team. Programmer.
    </p>
    <p style="margin-top: 4em">
      <a href="/gallery">Some Sites</a>
    </p>
  </div>
</div>

<div id="sites" style="display: none">
</div>

<script type="text/template" id="sites-template">
  <div id="bar">
    <ul id="site-list" class="unstyled">
      <li>
        <a href="/">
          Paul McKellar
        </a>
      </li>
      <li>
        <a href="/gallery" data-sitename="gallery" data-siteurl="http://gallery-pm.revore.com/">Gallery</a>
      </li>
      <li>
        <a href="/github" data-sitename="github" data-siteurl="http://github-pm.revore.com/">Github</a>
      </li>
      <li>
        <a href="/bucketlist" data-sitename="bucketlist" data-siteurl="http://bucketlist-pm.revore.com/">Bucket List</a>
      </li>
      <li>
        <a href="/products" data-sitename="product" data-siteurl="http://iusethis-pm.revore.com/">Products</a>
      </li>
    </ul>
  </div>
  <div id="app-preview-wrapper">
    <iframe id="preview" src="http://gallery-pm.revore.com/"></iframe>
  </div>
</script>

<img src="http://junojs.imgix.net/files/c679179b-65d2-4d4d-aaa6-3d63c315fda4.jpeg?w=1024&h=1024&fit=max&s=9cc7c5f04f030b4dc190e0e9aa15f4c8" id="background" style='display: none'/>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.10/backbone-min.js"></script>

<style type="text/css">
  @import url("//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.0/css/bootstrap-combined.min.css");
/* line 10, app.sass */
body {
  background-color: white;
}

/* line 13, app.sass */
#background {
  z-index: -1;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
}

/* line 21, app.sass */
h1 {
  margin-bottom: 0.5em;
  margin-top: 0;
}

/* line 25, app.sass */
#card {
  -webkit-box-shadow: 3px 3px 60px 1px black;
  -moz-box-shadow: 3px 3px 60px 1px black;
  box-shadow: 3px 3px 60px 1px black;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  -ms-border-radius: 2px;
  -o-border-radius: 2px;
  border-radius: 2px;
  margin: 0 auto;
  margin-top: 5em;
  padding: 3em 5em 2em 5em;
  width: 300px;
  background: white;
  color: black;
  text-align: center;
  border: 1px solid silver;
}
@media (max-width: 479px) {
  /* line 25, app.sass */
  #card {
    margin-top: 1em;
    width: 200px;
  }
}

/* line 41, app.sass */
#sites {
  width: 100%;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
}

/* line 51, app.sass */
#bar {
  background-color: white;
  position: fixed;
  top: 0;
  left: 0;
  width: 200px;
  height: 100%;
}

/* line 60, app.sass */
#site-list li:hover {
  background-color: #eeeeee;
}
/* line 62, app.sass */
#site-list a {
  padding: 1em;
  width: 100%;
  display: block;
}
/* line 66, app.sass */
#site-list a, #site-list a:hover, #site-list a:active, #site-list a:visited {
  text-decoration: none;
}

/* line 69, app.sass */
#app-preview-wrapper {
  position: fixed;
  left: 200px;
  right: 0;
  float: left;
  height: 100%;
}

/* line 76, app.sass */
iframe {
  border: none;
  border-left: 1px solid #dddddd;
  height: 100%;
  width: 100%;
  background-color: white;
}

</style>

<script type="text/javascript">
  // Generated by CoffeeScript 1.6.3
(function() {
  var Router, SitesView, getAnchor, logDebug, router, sitesView, sizeBackground;

  logDebug = false;

  $.fn.fullBg = function() {
    var bgImg, resizeImg;
    resizeImg = function() {
      var heightdiff, heightratio, imgheight, imgwidth, widthdiff, widthratio, winheight, winwidth;
      imgwidth = bgImg.width();
      imgheight = bgImg.height();
      winwidth = $(window).width();
      winheight = $(window).height();
      widthratio = winwidth / imgwidth;
      heightratio = winheight / imgheight;
      widthdiff = heightratio * imgwidth;
      heightdiff = widthratio * imgheight;
      if (heightdiff > winheight) {
        return bgImg.css({
          width: winwidth + "px",
          height: heightdiff + "px"
        });
      } else {
        return bgImg.css({
          width: widthdiff + "px",
          height: winheight + "px"
        });
      }
    };
    bgImg = $(this);
    resizeImg();
    return $(window).resize(function() {
      return resizeImg();
    });
  };

  sizeBackground = function() {
    return $("#background").show().fullBg();
  };

  sizeBackground();

  setTimeout(sizeBackground, 1000);

  SitesView = Backbone.View.extend({
    el: '#sites',
    className: "pane",
    template: _.template($('#sites-template').html()),
    render: function() {
      this.$el.html(this.template());
      this.setLinks();
      return this;
    },
    initialize: function() {},
    setLinks: function() {
      return $("a[data-siteurl]").click(function(e) {
        var link;
        e.preventDefault();
        link = $(this);
        if (logDebug) {
          console.log("preview", link.data("sitename"), link.data("siteurl"));
        }
        router.navigate(link.data("sitename"), true);
        return false;
      });
    }
  });

  sitesView = new SitesView();

  sitesView.render();

  Router = Backbone.Router.extend({
    routes: {
      "": "profile",
      "*path": "sitename"
    },
    profile: function() {
      $(".page").hide();
      return $("#card").show();
    },
    sitename: function(_path) {
      var endUrlFragment, previewFrame, siteurl, _sitename;
      _sitename = _path.split("/")[0];
      endUrlFragment = _path.slice(7);
      $(".page").hide();
      sitesView.render();
      $("#sites").show();
      if (logDebug) {
        console.log("sitename", _sitename);
      }
      siteurl = $("a[data-sitename='" + _sitename + "']").data("siteurl");
      previewFrame = document.getElementById("preview");
      return previewFrame.contentWindow.location = siteurl + endUrlFragment;
    }
  });

  router = new Router();

  getAnchor = function() {
    var i, url;
    url = window.location.href;
    i = url.indexOf("#") + 1;
    if (i === 0) {
      return null;
    } else {
      return url.substring(i);
    }
  };

  $(window).on("hashchange", function() {
    return router.navigate(getAnchor(), true);
  });

  $("a").click(function(e) {
    var href, protocol;
    e.preventDefault();
    href = $(this).attr("href");
    protocol = this.protocol + "//";
    if (href.slice(protocol.length) !== protocol) {
      return router.navigate(href, true);
    }
  });

  setTimeout(function() {
    if (logDebug) {
      console.log(window.location.pathname);
    }
    router.navigate(window.location.pathname.slice(1), {
      trigger: true
    });
    return Backbone.history.start({
      pushState: true,
      hashChange: false
    });
  }, 500);

}).call(this);

</script>